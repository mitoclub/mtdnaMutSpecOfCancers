rm(list=ls(all=TRUE))
library(dplyr)
library(tidyr)
library(ggplot2)
Mut = read.table("../../Body/1Raw/mtDNA_snv_Oct2016.txt", head = TRUE, sep = '\t')
rm(list=ls(all=TRUE))
library(dplyr)
library(tidyr)
library(ggplot2)
Mut = read.table("../../dara/1raw/mtDNA_snv_Oct2016.txt", head = TRUE, sep = '\t')
Mut = read.table("../dara/1raw/mtDNA_snv_Oct2016.txt", head = TRUE, sep = '\t')
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
library(knitr)
library(tidyverse)
library(kableExtra)
library(dplyr)
library(tidyr)
library(ggplot2)
Mut = read.table("../data/1raw/mtDNA_snv_Oct2016.txt", head = TRUE, sep = '\t')
names(Mut)
Mut$Subst = paste(Mut$ref,Mut$var,sep = '>')
table(Mut$Subst) # light chain notation is be default
table(Mut$Tier2) # cancer tissue
Mut$tumor_var_freq = as.numeric(gsub('%','',Mut$tumor_var_freq))
summary(Mut$tumor_var_freq)
hist(Mut$position, breaks = 200)
CancerTissue = c('Bladder','Bone/SoftTissue','Breast','Biliary','Cervix','Lymphoid','Myeloid','Colon/Rectum','Prostate','Esophagus','Stomach','CNS','Head/Neck','Kidney','Liver','Lung','Ovary','Pancreas','Skin','Thyroid','Uterus')
TurnOverDays = c(200,5373,84.5,200,6,30,30,5,120,11,5.5,10000,16,1000,400,5143,11000,360,147,4138,4); length(TurnOverDays)
Turn = data.frame(CancerTissue,TurnOverDays)
Turn = Turn[order(Turn$TurnOverDays),]
Mut = merge(Mut,Turn, by.x = 'Tier2', by.y = 'CancerTissue')
summary(Mut$TurnOverDays) # there are no NA - good
Mut$TBSS = NA
for (i in 1:nrow(Mut))
{ # i = 1
if (Mut$position[i] > 576 & Mut$position[i] < 5721) # minor arc
{Mut$TBSS[i] = 16569-(5721 - Mut$position[i])*2} # L-strand replication origin (locus MT-OLR, 5721 - 5798)
if (Mut$position[i] > 5798 & Mut$position[i] < 16024) # major arc
{Mut$TBSS[i] = 16569-(Mut$position[i] - 5798)*2}
}
summary(Mut$TBSS)
plot(Mut$position,Mut$TBSS)
View(Mut)
Mut$DummyAhGh = 0; Mut$DummyChTh = 0; Mut$Ts = 0; Mut$Tv = 0;
for (i in 1:nrow(Mut))
{ # i=1
if Mut$Subst[i]
i=1
Mut$Subst[i]
Mut$DummyAhGh = 0; Mut$DummyChTh = 0; Mut$DummyTs = 0; Mut$DummyTv = 0;
i=1
if (Mut$Subst[i] = 'T>C') {Mut$DummyAhGh[i] = 1}
if (Mut$Subst[i] = 'T>C') {Mut$DummyAhGh[i] = 1}
if (Mut$Subst[i] = 'T>C') {Mut$DummyAhGh[i] = 1}
if (Mut$Subst[i] = 'T>C') {Mut$DummyAhGh[i] = 1}
Mut$Subst[i]
if (Mut$Subst[i] = 'G>A') {Mut$DummyChTh[i] = 1}
if (Mut$Subst[i] == 'G>A') {Mut$DummyChTh[i] = 1}
table(Mut$DummyChTh)
table(Mut$DummyAhGh)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
library(knitr)
library(tidyverse)
library(kableExtra)
library(dplyr)
library(tidyr)
library(ggplot2)
Mut = read.table("../data/1raw/mtDNA_snv_Oct2016.txt", head = TRUE, sep = '\t')
names(Mut)
Mut$Subst = paste(Mut$ref,Mut$var,sep = '>')
table(Mut$Subst) # light chain notation is be default
table(Mut$Tier2) # cancer tissue
Mut$tumor_var_freq = as.numeric(gsub('%','',Mut$tumor_var_freq))
summary(Mut$tumor_var_freq)
hist(Mut$position, breaks = 200)
CancerTissue = c('Bladder','Bone/SoftTissue','Breast','Biliary','Cervix','Lymphoid','Myeloid','Colon/Rectum','Prostate','Esophagus','Stomach','CNS','Head/Neck','Kidney','Liver','Lung','Ovary','Pancreas','Skin','Thyroid','Uterus')
TurnOverDays = c(200,5373,84.5,200,6,30,30,5,120,11,5.5,10000,16,1000,400,5143,11000,360,147,4138,4); length(TurnOverDays)
Turn = data.frame(CancerTissue,TurnOverDays)
Turn = Turn[order(Turn$TurnOverDays),]
Mut = merge(Mut,Turn, by.x = 'Tier2', by.y = 'CancerTissue')
summary(Mut$TurnOverDays) # there are no NA - good
Mut$TBSS = NA
for (i in 1:nrow(Mut))
{ # i = 1
if (Mut$position[i] > 576 & Mut$position[i] < 5721) # minor arc
{Mut$TBSS[i] = 16569-(5721 - Mut$position[i])*2} # L-strand replication origin (locus MT-OLR, 5721 - 5798)
if (Mut$position[i] > 5798 & Mut$position[i] < 16024) # major arc
{Mut$TBSS[i] = 16569-(Mut$position[i] - 5798)*2}
}
summary(Mut$TBSS)
plot(Mut$position,Mut$TBSS)
Mut$DummyAhGh = 0; Mut$DummyChTh = 0; Mut$DummyTs = 0; Mut$DummyTv = 0;
for (i in 1:nrow(Mut))
{ # i=1
if (Mut$Subst[i] == 'T>C') {Mut$DummyAhGh[i] = 1}
if (Mut$Subst[i] == 'G>A') {Mut$DummyChTh[i] = 1}
if (Mut$Subst[i] %in% c('G>A','T>C','C>T','A>G')) {Mut$DummyTs[i] = 1}
if (!Mut$Subst[i] %in% c('G>A','T>C','C>T','A>G')) {Mut$DummyTv[i] = 1}
}
table(Mut$DummyAhGh)
table(Mut$DummyChTh)
table(Mut$DummyTs)
table(Mut$DummyTv)
m1<-glm(Mut$DummyAhGh ~ Mut$TBSS, family = binomial)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
library(knitr)
library(tidyverse)
library(kableExtra)
library(dplyr)
library(tidyr)
library(ggplot2)
Mut = read.table("../data/1raw/mtDNA_snv_Oct2016.txt", head = TRUE, sep = '\t')
names(Mut)
Mut$Subst = paste(Mut$ref,Mut$var,sep = '>')
table(Mut$Subst) # light chain notation is be default
table(Mut$Tier2) # cancer tissue
Mut$tumor_var_freq = as.numeric(gsub('%','',Mut$tumor_var_freq))
summary(Mut$tumor_var_freq)
hist(Mut$position, breaks = 200)
CancerTissue = c('Bladder','Bone/SoftTissue','Breast','Biliary','Cervix','Lymphoid','Myeloid','Colon/Rectum','Prostate','Esophagus','Stomach','CNS','Head/Neck','Kidney','Liver','Lung','Ovary','Pancreas','Skin','Thyroid','Uterus')
TurnOverDays = c(200,5373,84.5,200,6,30,30,5,120,11,5.5,10000,16,1000,400,5143,11000,360,147,4138,4); length(TurnOverDays)
Turn = data.frame(CancerTissue,TurnOverDays)
Turn = Turn[order(Turn$TurnOverDays),]
Mut = merge(Mut,Turn, by.x = 'Tier2', by.y = 'CancerTissue')
summary(Mut$TurnOverDays) # there are no NA - good
Mut$TBSS = NA
for (i in 1:nrow(Mut))
{ # i = 1
if (Mut$position[i] > 576 & Mut$position[i] < 5721) # minor arc
{Mut$TBSS[i] = 16569-(5721 - Mut$position[i])*2} # L-strand replication origin (locus MT-OLR, 5721 - 5798)
if (Mut$position[i] > 5798 & Mut$position[i] < 16024) # major arc
{Mut$TBSS[i] = 16569-(Mut$position[i] - 5798)*2}
}
summary(Mut$TBSS)
plot(Mut$position,Mut$TBSS)
Mut$DummyAhGh = 0; Mut$DummyChTh = 0; Mut$DummyTs = 0; Mut$DummyTv = 0;
for (i in 1:nrow(Mut))
{ # i=1
if (Mut$Subst[i] == 'T>C') {Mut$DummyAhGh[i] = 1}
if (Mut$Subst[i] == 'G>A') {Mut$DummyChTh[i] = 1}
if (Mut$Subst[i] %in% c('G>A','T>C','C>T','A>G')) {Mut$DummyTs[i] = 1}
if (!Mut$Subst[i] %in% c('G>A','T>C','C>T','A>G')) {Mut$DummyTv[i] = 1}
}
table(Mut$DummyAhGh)
table(Mut$DummyChTh)
table(Mut$DummyTs)
table(Mut$DummyTv)
summary(glm(Mut$DummyAhGh ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyTs ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyTs ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyTv ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyTs ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyTv ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TurnOverDays, family = binomial))
Mut[!is.na(Mut$TBSS),]
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TBSS, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$TBSS, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TBSS, family = binomial)) # marginally significnat and negative > due to strong positive effect of C>T
summary(glm(Mut$DummyChTh ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyTs ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyTv ~ Mut$TBSS, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TurnOverDays, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$TurnOverDays, family = binomial))
summary(glm(Mut$DummyTs ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyTv ~ Mut$TBSS, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyChTh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$TurnOverDays, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyChTh ~ Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TurnOverDays, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS, family = binomial)) # marginally significnat and
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TBSS, family = binomial)) # marginally significnat and
summary(glm(Mut$DummyChTh ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$TurnOverDays + tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$TurnOverDays + Mut$tumor_var_freq, family = binomial))
nrow(Mut[!is.na(Mut$TBSS),])
nrow(Mut[!is.na(Mut$TBSS),])
nrow(Mut[is.na(Mut$TBSS),])
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$TurnOverDays + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TBSS + Mut[!is.na(Mut$TBSS),]$TurnOverDays + Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$TurnOverDays + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TBSS + Mut[!is.na(Mut$TBSS),]$TurnOverDays + Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$TurnOverDays + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TBSS + Mut[!is.na(Mut$TBSS),]$TurnOverDays + Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$TurnOverDays + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$TurnOverDays*Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS*Mut$TurnOverDays+Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS*(Mut$TurnOverDays+Mut$tumor_var_freq), family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS*Mut$TurnOverDays+Mut$tumor_var_freq, family = binomial)) # negative interaction between
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$TurnOverDays + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TurnOverDays + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays + Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TurnOverDays + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1),]$DummyAhGh ~ Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1),]$TBSS + Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1),]$TurnOverDays + Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1),]$tumor_var_freq, family = binomial))
summary(glm(Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1,]$DummyAhGh ~ Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1,]$TBSS + Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1,]$TurnOverDays + Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1,]$tumor_var_freq, family = binomial))
summary(glm(Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1,]$DummyAhGh ~ Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1,]$TurnOverDays + Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1,]$tumor_var_freq, family = binomial))
summary(glm(Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1,]$DummyAhGh ~ Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1,]$TurnOverDays + Mut[Mut$DummyTv == 1 | Mut$DummyAhGh == 1,]$tumor_var_freq, family = binomial))
summary(Turn$TurnOverDays)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
library(knitr)
library(tidyverse)
library(kableExtra)
library(dplyr)
library(tidyr)
library(ggplot2)
Mut = read.table("../data/1raw/mtDNA_snv_Oct2016.txt", head = TRUE, sep = '\t')
names(Mut)
Mut$Subst = paste(Mut$ref,Mut$var,sep = '>')
table(Mut$Subst) # light chain notation is be default
table(Mut$Tier2) # cancer tissue
Mut$tumor_var_freq = as.numeric(gsub('%','',Mut$tumor_var_freq))
summary(Mut$tumor_var_freq)
hist(Mut$position, breaks = 200)
CancerTissue = c('Bladder','Bone/SoftTissue','Breast','Biliary','Cervix','Lymphoid','Myeloid','Colon/Rectum','Prostate','Esophagus','Stomach','CNS','Head/Neck','Kidney','Liver','Lung','Ovary','Pancreas','Skin','Thyroid','Uterus')
TurnOverDays = c(200,5373,84.5,200,6,30,30,5,120,11,5.5,10000,16,1000,400,5143,11000,360,147,4138,4); length(TurnOverDays)
Turn = data.frame(CancerTissue,TurnOverDays)
Turn = Turn[order(Turn$TurnOverDays),]
summary(Turn$TurnOverDays)
Turn$DummySlowTurnOver = 0;
for (i in 1:nrow(Turn)) {
if (Turn$TurnOverDays[i] > 1000) {Turn$DummySlowTurnOver[i] = 1} } # if  slower than the third quartile (1000 days)
Turn
Mut = merge(Mut,Turn, by.x = 'Tier2', by.y = 'CancerTissue')
summary(Mut$TurnOverDays) # there are no NA - good
Mut$TBSS = NA
for (i in 1:nrow(Mut))
{ # i = 1
if (Mut$position[i] > 576 & Mut$position[i] < 5721) # minor arc
{Mut$TBSS[i] = 16569-(5721 - Mut$position[i])*2} # L-strand replication origin (locus MT-OLR, 5721 - 5798)
if (Mut$position[i] > 5798 & Mut$position[i] < 16024) # major arc
{Mut$TBSS[i] = 16569-(Mut$position[i] - 5798)*2}
}
summary(Mut$TBSS)
plot(Mut$position,Mut$TBSS)
Mut$DummyAhGh = 0; Mut$DummyChTh = 0; Mut$DummyTs = 0; Mut$DummyTv = 0;
for (i in 1:nrow(Mut))
{ # i=1
if (Mut$Subst[i] == 'T>C') {Mut$DummyAhGh[i] = 1}
if (Mut$Subst[i] == 'G>A') {Mut$DummyChTh[i] = 1}
if (Mut$Subst[i] %in% c('G>A','T>C','C>T','A>G')) {Mut$DummyTs[i] = 1}
if (!Mut$Subst[i] %in% c('G>A','T>C','C>T','A>G')) {Mut$DummyTv[i] = 1}
}
table(Mut$DummyAhGh)
table(Mut$DummyChTh)
table(Mut$DummyTs)
table(Mut$DummyTv)
summary(glm(Mut$DummyAhGh ~ Mut$TBSS, family = binomial)) # marginally significant and negative (probably due to strong positive effect of C>T)
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TBSS, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TurnOverDays, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$TurnOverDays, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyChTh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyChTh ~ Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$DummySlowTurnOver + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$DummySlowTurnOver + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$DummySlowTurnOver*Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$DummySlowTurnOver + Mut$tumor_var_freq, family = binomial))
summary(Turn$TurnOverDays)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
library(knitr)
library(tidyverse)
library(kableExtra)
library(dplyr)
library(tidyr)
library(ggplot2)
Mut = read.table("../data/1raw/mtDNA_snv_Oct2016.txt", head = TRUE, sep = '\t')
names(Mut)
Mut$Subst = paste(Mut$ref,Mut$var,sep = '>')
table(Mut$Subst) # light chain notation is be default
table(Mut$Tier2) # cancer tissue
Mut$tumor_var_freq = as.numeric(gsub('%','',Mut$tumor_var_freq))
summary(Mut$tumor_var_freq)
hist(Mut$position, breaks = 200)
CancerTissue = c('Bladder','Bone/SoftTissue','Breast','Biliary','Cervix','Lymphoid','Myeloid','Colon/Rectum','Prostate','Esophagus','Stomach','CNS','Head/Neck','Kidney','Liver','Lung','Ovary','Pancreas','Skin','Thyroid','Uterus')
TurnOverDays = c(200,5373,84.5,200,6,30,30,5,120,11,5.5,10000,16,1000,400,5143,11000,360,147,4138,4); length(TurnOverDays)
Turn = data.frame(CancerTissue,TurnOverDays)
Turn = Turn[order(Turn$TurnOverDays),]
summary(Turn$TurnOverDays)
Turn$DummySlowTurnOver = 0;
Turn$DummyVerySlowTurnOver = 0;
for (i in 1:nrow(Turn))
{
if (Turn$TurnOverDays[i] > 1000) {Turn$DummyVerySlowTurnOver[i] = 1} # if  slower than the third quartile (1000 days)
if (Turn$TurnOverDays[i] > 147)  {Turn$DummySlowTurnOver[i] = 1}  # if  slower than the median (147 days)
}
Turn
Mut = merge(Mut,Turn, by.x = 'Tier2', by.y = 'CancerTissue')
summary(Mut$TurnOverDays) # there are no NA - good
Mut$TBSS = NA
for (i in 1:nrow(Mut))
{ # i = 1
if (Mut$position[i] > 576 & Mut$position[i] < 5721) # minor arc
{Mut$TBSS[i] = 16569-(5721 - Mut$position[i])*2} # L-strand replication origin (locus MT-OLR, 5721 - 5798)
if (Mut$position[i] > 5798 & Mut$position[i] < 16024) # major arc
{Mut$TBSS[i] = 16569-(Mut$position[i] - 5798)*2}
}
summary(Mut$TBSS)
plot(Mut$position,Mut$TBSS)
Mut$DummyAhGh = 0; Mut$DummyChTh = 0; Mut$DummyTs = 0; Mut$DummyTv = 0;
for (i in 1:nrow(Mut))
{ # i=1
if (Mut$Subst[i] == 'T>C') {Mut$DummyAhGh[i] = 1}
if (Mut$Subst[i] == 'G>A') {Mut$DummyChTh[i] = 1}
if (Mut$Subst[i] %in% c('G>A','T>C','C>T','A>G')) {Mut$DummyTs[i] = 1}
if (!Mut$Subst[i] %in% c('G>A','T>C','C>T','A>G')) {Mut$DummyTv[i] = 1}
}
table(Mut$DummyAhGh)
table(Mut$DummyChTh)
table(Mut$DummyTs)
table(Mut$DummyTv)
summary(glm(Mut$DummyAhGh ~ Mut$TBSS, family = binomial)) # marginally significant and negative (probably due to strong positive effect of C>T)
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TBSS, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TurnOverDays, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$TurnOverDays, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyChTh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyChTh ~ Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$DummySlowTurnOver + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$DummySlowTurnOver + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS*Mut$TurnOverDays+Mut$tumor_var_freq, family = binomial)) # negative interaction between TBSS and TurnOverDays
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$TurnOverDays+Mut$tumor_var_freq, family = binomial)) # negative interaction between
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$tumor_var_freq, family = binomial)) # negative interaction between TBSS and
summary(glm(Mut$DummyAhGh ~ Mut$TurnOverDays+Mut$tumor_var_freq, family = binomial)) # negative interaction between TBSS and
Turn$DummyNotFastTurnOver = 0;
Turn$DummyNotFastTurnOver = 0;
summary(Turn$TurnOverDays)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
library(knitr)
library(tidyverse)
library(kableExtra)
library(dplyr)
library(tidyr)
library(ggplot2)
Mut = read.table("../data/1raw/mtDNA_snv_Oct2016.txt", head = TRUE, sep = '\t')
names(Mut)
Mut$Subst = paste(Mut$ref,Mut$var,sep = '>')
table(Mut$Subst) # light chain notation is be default
table(Mut$Tier2) # cancer tissue
Mut$tumor_var_freq = as.numeric(gsub('%','',Mut$tumor_var_freq))
summary(Mut$tumor_var_freq)
hist(Mut$position, breaks = 200)
CancerTissue = c('Bladder','Bone/SoftTissue','Breast','Biliary','Cervix','Lymphoid','Myeloid','Colon/Rectum','Prostate','Esophagus','Stomach','CNS','Head/Neck','Kidney','Liver','Lung','Ovary','Pancreas','Skin','Thyroid','Uterus')
TurnOverDays = c(200,5373,84.5,200,6,30,30,5,120,11,5.5,10000,16,1000,400,5143,11000,360,147,4138,4); length(TurnOverDays)
Turn = data.frame(CancerTissue,TurnOverDays)
Turn = Turn[order(Turn$TurnOverDays),]
summary(Turn$TurnOverDays)
Turn$DummyNotFastTurnOver = 0;
Turn$DummySlowTurnOver = 0;
Turn$DummyVerySlowTurnOver = 0;
for (i in 1:nrow(Turn))
{
if (Turn$TurnOverDays[i] > 1000) {Turn$DummyVerySlowTurnOver[i] = 1} # if  slower than the third quartile (1000 days)
if (Turn$TurnOverDays[i] > 147)  {Turn$DummySlowTurnOver[i] = 1}  # if  slower than the median (147 days)
if (Turn$TurnOverDays[i] > 16)  {Turn$DummyNotFastTurnOver[i] = 1}  # if  slower than the median (147 days)
}
Turn
Mut = merge(Mut,Turn, by.x = 'Tier2', by.y = 'CancerTissue')
summary(Mut$TurnOverDays) # there are no NA - good
Mut$TBSS = NA
for (i in 1:nrow(Mut))
{ # i = 1
if (Mut$position[i] > 576 & Mut$position[i] < 5721) # minor arc
{Mut$TBSS[i] = 16569-(5721 - Mut$position[i])*2} # L-strand replication origin (locus MT-OLR, 5721 - 5798)
if (Mut$position[i] > 5798 & Mut$position[i] < 16024) # major arc
{Mut$TBSS[i] = 16569-(Mut$position[i] - 5798)*2}
}
summary(Mut$TBSS)
plot(Mut$position,Mut$TBSS)
Mut$DummyAhGh = 0; Mut$DummyChTh = 0; Mut$DummyTs = 0; Mut$DummyTv = 0;
for (i in 1:nrow(Mut))
{ # i=1
if (Mut$Subst[i] == 'T>C') {Mut$DummyAhGh[i] = 1}
if (Mut$Subst[i] == 'G>A') {Mut$DummyChTh[i] = 1}
if (Mut$Subst[i] %in% c('G>A','T>C','C>T','A>G')) {Mut$DummyTs[i] = 1}
if (!Mut$Subst[i] %in% c('G>A','T>C','C>T','A>G')) {Mut$DummyTv[i] = 1}
}
table(Mut$DummyAhGh)
table(Mut$DummyChTh)
table(Mut$DummyTs)
table(Mut$DummyTv)
summary(glm(Mut$DummyAhGh ~ Mut$TBSS, family = binomial)) # marginally significant and negative (probably due to strong positive effect of C>T)
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TBSS, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$TBSS, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TurnOverDays, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$TurnOverDays, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyChTh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyChTh ~ Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyChTh ~ Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$TurnOverDays + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TurnOverDays + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$TurnOverDays + Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TurnOverDays + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$DummyNotFastTurnOver + Mut$tumor_var_freq, family = binomial))
summary(glm(Mut$DummyAhGh ~ Mut$TBSS + Mut$DummyNotFastTurnOver + Mut$tumor_var_freq, family = binomial)) # !!!!
summary(glm(Mut$DummyAhGh ~ Mut$DummyNotFastTurnOver + Mut$tumor_var_freq, family = binomial)) # !!!!
summary(glm(Mut[!is.na(Mut$TBSS),]$DummyAhGh ~ Mut[!is.na(Mut$TBSS),]$DummyNotFastTurnOver + Mut[!is.na(Mut$TBSS),]$tumor_var_freq, family = binomial)) # !!!!
summary(glm(Mut$DummyAhGh ~ Mut$DummyNotFastTurnOver + Mut$tumor_var_freq, family = binomial)) # !!!!
summary(glm(Mut$DummyChTh ~ Mut$DummyNotFastTurnOver + Mut$tumor_var_freq, family = binomial)) # !!!!
summary(glm(Mut$DummyAhGh ~ Mut$DummyNotFastTurnOver*Mut$tumor_var_freq, family = binomial)) # !!!!
